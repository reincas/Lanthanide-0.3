# (c) 01/2001 by Reinhard Caspary

from Lanthanide import *

# W. T. Carnall, 1968 (Free Ion)
aparms = [
    [      0.00, "offset",    1 ],
    [   4864.60,  "e1",       0 ],
    [     23.138, "e2",       0 ],
    [    488.11,  "e3",       0 ],
    [    758.82,  "H2",       0 ],
    [     23.684, "H3:0",     0 ],
    [   -585.41,  "H3:1",     0 ],
    [    727.78,  "H3:2",     0 ],
]
aenergies = [
    [  0, "3H4",    20,  1 ],
    [  1, "3H5",  2147,  1 ],
    [  2, "3H6",  4375,  1 ],
    [  3, "3F2",  4989,  1 ],
    [  4, "3F3",  6406,  1 ],
    [  5, "3F4",  6888,  1 ],
    [  6, "1G4",  9903,  1 ],
    [  7, "1D2", 17329,  1 ],
    [  8, "3P0", 21362,  1 ],
    [  9, "3P1", 21984,  1 ],
    [ 10, "1I6", 22111,  1 ],
    [ 11, "3P2", 23214,  1 ],
    [ 12, "1S0", 50090,  1 ],
    ]

# W. T. Carnall, 1968 (LaF3)
aparms = [
    [  12000.00, "offset",    1 ],
    [   4548.10,  "e1",       1 ],
    [     21.659, "e2",       1 ],
    [    470.02,  "e3",       1 ],
    [    743.24,  "H2",       1 ],
    [     18.642, "H3:0",     1 ],
    [   -754.20,  "H3:1",     1 ],
    [   1396.20,  "H3:2",     1 ],
]
calc_energies = [
    [  0, "3H4",   228,  1 ],
    [  1, "3H5",  2309,  1 ],
    [  2, "3H6",  4490,  1 ],
    [  3, "3F2",  5182,  1 ],
    [  4, "3F3",  6581,  1 ],
    [  5, "3F4",  7044,  1 ],
    [  6, "1G4",  9989,  1 ],
    [  7, "1D2", 16850,  1 ],
    [  8, "3P0", 20899,  1 ],
    [  9, "1I6", 21519,  1 ],
    [ 10, "3P1", 21528,  1 ],
    [ 11, "3P2", 22722,  1 ],
    [ 12, "1S0", 46900,  1 ],
    ]
meas_energies = [
    [  0, "3H4",   200,  1 ],
    [  1, "3H5",  2363,  1 ],
    [  2, "3H6",  4464,  1 ],
    [  3, "3F2",  5215,  1 ],
    [  4, "3F3",  6555,  1 ],
    [  5, "3F4",  7031,  1 ],
    [  6, "1G4",  9997,  1 ],
    [  7, "1D2", 16846,  1 ],
    [  8, "3P0", 20925,  1 ],
    [  9, "1I6", 21473,  1 ],
    [ 10, "3P1", 21519,  1 ],
    [ 11, "3P2", 22754,  1 ],
    [ 12, "1S0", 46900,  1 ],
    ]

l = 3
electrons = 2
Pr = Ion(l, electrons, parms)
Pr.buildTerm(TERM_SLJ)

diff = 1
while diff > 0.001:
    Pr.parms[0][2] = 0
    Pr.parms[-1][2] = 1
    p,chi2 = Pr.termFit(energies)
    Pr.parms[0][2] = 1
    Pr.parms[-1][2] = 0
    p,nchi2 = Pr.termFit(energies)
    diff = chi2-nchi2
    
