#
# (c) 1970 by W. T. Carnall et al.
# (c) 02/2001 by Reinhard Caspary
#
# Data from:
#   W. T. Carnall, P. R. Fields, J. Morrison, R. Sarup
#   "Absorptions Spectrum of Tm(3+):LaF3"
#   J Chem Phys 52(8), 1970, pp. 4054-4059
#

from Lanthanide import *
from Ion import *


# Parameters 1:
parms1 = [
    [ 280029.0,   "offset",   1 ],
    [   6737.5,   "e1",       1 ],
    [     33.643, "e2",       1 ],
    [    681.22,  "e3",       1 ],
    [   2633.0,   "H2",       1 ],
    [     13.124, "H3:0",     1 ],
    [   -743.02,  "H3:1",     1 ],
    [   1992.2,   "H3:2",     1 ],
    ]

# Parameters 2:
parms2 = [
    [    287489.7,   "offset",   1 ],
    [      6911.8,   "e1",       1 ],
    [        33.728, "e2",       1 ],
    [       675.28,  "e3",       1 ],
    [      2593.9,   "H2",       1 ],
    [         9.475, "H3:0",     1 ],
    [      -601.09,  "H3:1",     1 ],
    [      1395.1,   "H3:2",     1 ],
    [         5.002, "H5:0",     1 ],
    [         2.801, "H5:2",     1 ],
    [         1.901, "H5:4",     1 ],
    [     225*3.915, "H6:2",     1 ],
    [    1089*0.090, "H6:4",     1 ],
    [ 7361.64*0.070, "H6:6",     1 ],
    ]

# Measurement:
meas = [
    [  0, "3H6",   100,  1 ],
    [  1, "3F4",  5858,  1 ],
    [  2, "3H5",  8336,  1 ],
    [  3, "3H4", 12711,  1 ],
    [  4, "3F3", 14559,  1 ],
    [  5, "3F2", 15173,  1 ],
    [  6, "1G4", 21352,  1 ],
    [  7, "1D2", 28061,  1 ],
#    [  8, "1I6", 34886,  1 ],
    [  8, "1I6", 34866,  1 ],  # calculation error of Carnall !?
    [  9, "3P0", 35604,  1 ],
    [ 10, "3P1", 36559,  1 ],
    [ 11, "3P2", 38344,  1 ],
    ]

# Calculation 1:
energies1 = [
    [  0, "3H6",   119,  1 ],
    [  1, "3F4",  5835,  1 ],
    [  2, "3H5",  8320,  1 ],
    [  3, "3H4", 12701,  1 ],
    [  4, "3F3", 14586,  1 ],
    [  5, "3F2", 15150,  1 ],
    [  6, "1G4", 21366,  1 ],
    [  7, "1D2", 28098,  1 ],
    [  8, "1I6", 34866,  1 ],
    [  9, "3P0", 35604,  1 ],
    [ 10, "3P1", 36562,  1 ],
    [ 11, "3P2", 38315,  1 ],
    [ 12, "1S0", 74405,  1 ],
    ]

# Calculation 2:
energies2 = [
    [  0, "3H6",   100+6.7,   1 ],
    [  1, "3F4",  5858-4.4,   1 ],
    [  2, "3H5",  8336-1.8,   1 ],
    [  3, "3H4", 12711-9.2,   1 ],
    [  4, "3F3", 14559+3.4,   1 ],
    [  5, "3F2", 15173+2.1,   1 ],
    [  6, "1G4", 21352+4.2,   1 ],
    [  7, "1D2", 28061-1.4,   1 ],
    [  8, "1I6", 34886-20.25, 1 ],
    [  9, "3P0", 35604-0.16,  1 ],
    [ 10, "3P1", 36559+0.08,  1 ],
    [ 11, "3P2", 38344+0.8,   1 ],
    ]

#Tm = Ion("Tm3+", parms1)
Tm = Ion("Tm3+", parms2)
Tm.Term(TERM_SLJ)
#Tm.Fit(energies1)
#Tm.Fit(energies2)
#Tm.Fit(meas)
#Tm.showLevels(energies1)
#Tm.showLevels(energies2)
Tm.showLevels(meas)
